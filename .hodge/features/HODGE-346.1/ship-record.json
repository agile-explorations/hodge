{
  "feature": "HODGE-346.1",
  "timestamp": "2025-10-16T14:08:40.318Z",
  "issueId": null,
  "pmTool": "linear",
  "validationPassed": true,
  "shipChecks": {
    "tests": true,
    "coverage": true,
    "docs": true,
    "changelog": true
  },
  "commitMessage": "fix(harden): resolve git rename shell expansion and validation bugs (HODGE-346.1)\n\nFix critical bugs preventing harden workflow --review mode from working properly.\nGit renamed files caused shell expansion errors, and several validation tools had\nissues with file path handling. This completes the cleanup phase after hardening\npassed all validation checks.\n\n## What Changed\n\n### Bug Fixes (4 critical issues)\n- **git-diff-analyzer.ts** (+27 lines): Added parseRenamedPath() method to extract\n  actual file paths from git rename notation {old => new}\n  - Prevents ReDoS vulnerability by replacing regex with string parsing\n  - Uses indexOf() and substring() for linear-time path extraction\n\n- **toolchain-service.ts** (+53 lines): Fixed shell expansion and rename handling\n  - Added shell escaping in substituteFiles(): wraps paths in single quotes\n  - Added parseRenamedPath() method matching git-diff-analyzer implementation\n  - Updated getFeatureFiles() and getUncommittedFiles() to parse renames\n  - Removed unnecessary defensive check (tools validated by config)\n\n- **review-engine-service.ts** (+1 line): Fixed null check in isAutoFixable()\n  - Added early return pattern to prevent undefined property access\n  - Resolves \"Cannot read properties of undefined (reading 'fix_command')\" error\n\n- **git-utils.ts** (-11 lines): Code cleanup\n  - Added [ship] phase markers to TODO comments (lines 109, 128)\n  - Fixed nullish coalescing (replaced || with ??)\n  \n### Test Updates\n- **profile-loading.smoke.test.ts** (+2 lines): Updated expected profile count\n  from 43 to 44 to account for new UX profile added in HODGE-346.1\n\n### Build Configuration\n- **package.json** (+2 lines): Added bundled-config directory to build script\n  - Fixes \"ENOENT: no such file or directory\" error for tool-registry.yaml\n\n### Quality Reports\n- **jscpd-report.json**: Regenerated duplication report (1.75% duplication)\n\n## Why This Change\n\n**Problem**: After creating UX review profile in HODGE-346.1, the harden workflow\n--review mode failed with multiple critical errors:\n1. Git renamed files caused shell expansion: `/bin/sh: HODGE-346}/explore/context.json`\n2. Missing bundled-config in dist/ directory\n3. ReviewEngineService undefined property access\n4. ReDoS regex vulnerability in rename path parsing\n\n**Root Cause**: Git shows renames as `.hodge/features/{HODGE-003 => HODGE-346}/explore/context.json`,\nwhich shells interpret as brace expansion. Tools attempting to validate these paths\nfailed with \"No such file or directory\" errors.\n\n**Solution**: Two-part fix:\n1. **Shell escaping**: Quote file paths to prevent expansion: `'path/to/file'`\n2. **Path parsing**: Extract actual file paths from git rename notation using\n   string parsing instead of regex (prevents ReDoS vulnerability)\n\n## Impact\n\n**For HODGE-346.1 Feature**:\n- âœ… Harden validation now passes (all 1075 tests, zero errors)\n- âœ… --review mode works correctly with renamed files\n- âœ… All quality checks passing (TypeScript, ESLint, Prettier, tests)\n- âœ… Feature is production-ready for shipping\n\n**For Codebase Health**:\n- Fixed 4 critical bugs blocking harden workflow\n- Eliminated ReDoS security vulnerability\n- Improved null safety in review engine\n- Build artifact completeness ensured\n- Code quality: 1.75% duplication (excellent)\n\n**Quality Gates**:\n- âœ… Tests: 1075/1075 passing\n- âœ… TypeScript: 0 errors (strict mode)\n- âœ… ESLint: 0 errors, 7 acceptable warnings\n- âœ… Build: Succeeded with all artifacts\n- âœ… Duplication: 1.75% (under 5% threshold)\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>"
}